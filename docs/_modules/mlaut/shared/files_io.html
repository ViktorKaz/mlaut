

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mlaut.shared.files_io &mdash; mlaut 0.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> mlaut
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../project.html">Description of the project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">Modules</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">mlaut</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>mlaut.shared.files_io</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for mlaut.shared.files_io</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">from</span> <span class="nn">.static_variables</span> <span class="k">import</span> <span class="p">(</span><span class="n">EXPERIMENTS_TRAINED_MODELS_DIR</span><span class="p">,</span> 
                               <span class="n">EXPERIMENTS_PREDICTIONS_GROUP</span><span class="p">,</span> 
                               <span class="n">EXPERIMENTS_MODEL_ACCURACY_DIR</span><span class="p">,</span> 
                               <span class="n">PICKLE_EXTENTION</span><span class="p">,</span> 
                               <span class="n">HDF5_EXTENTION</span><span class="p">,</span> 
                               <span class="n">REFORMATTED_DATASETS_DIR</span><span class="p">,</span>
                               <span class="n">RUNTIMES_GROUP</span><span class="p">,</span>
                               <span class="n">RESULTS_DIR</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">h5py</span>
<span class="kn">import</span> <span class="nn">tables</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">logging</span>

<div class="viewcode-block" id="DiskOperations"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.DiskOperations">[docs]</a><span class="k">class</span> <span class="nc">DiskOperations</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class with high level disk operations for loading and saving estimators.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="DiskOperations.save_to_pickle"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.DiskOperations.save_to_pickle">[docs]</a>    <span class="k">def</span> <span class="nf">save_to_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                       <span class="n">trained_model</span><span class="p">,</span> 
                       <span class="n">model_name</span><span class="p">,</span> 
                       <span class="n">dataset_name</span><span class="p">,</span> 
                       <span class="n">root_dir</span><span class="o">=</span><span class="n">EXPERIMENTS_TRAINED_MODELS_DIR</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;load_dataset_pd</span>
<span class="sd">        Saves sklearn estimator to disk as pickle file.</span>

<span class="sd">        Args:</span>
<span class="sd">            trained_model(sklearn estimator object): trained sklearn object to be saved on disk.</span>
<span class="sd">            model_name(string): name of sklearn estimator.</span>
<span class="sd">            dataset_name(string): name of dataset that the estimator was trained on.</span>
<span class="sd">            root_dir(string): root dir where the trained estimators will be saved. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">root_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">dataset_name</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">root_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">dataset_name</span><span class="p">)</span>
        
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">root_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">dataset_name</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">model_name</span> <span class="o">+</span> <span class="n">PICKLE_EXTENTION</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">trained_model</span><span class="p">,</span><span class="n">f</span><span class="p">)</span></div>

<div class="viewcode-block" id="DiskOperations.save_keras_model"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.DiskOperations.save_keras_model">[docs]</a>    <span class="k">def</span> <span class="nf">save_keras_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                        <span class="n">trained_model</span><span class="p">,</span> 
                        <span class="n">model_name</span><span class="p">,</span> 
                        <span class="n">dataset_name</span><span class="p">,</span> 
                        <span class="n">root_dir</span><span class="o">=</span><span class="n">EXPERIMENTS_TRAINED_MODELS_DIR</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves keras object to disk.</span>

<span class="sd">        :type trained_model: keras estimator object.</span>
<span class="sd">        :param trained_model: trained keras object to be saved on disk.</span>

<span class="sd">        :type model_name: string</span>
<span class="sd">        :param model_name: name of sklearn estimator.</span>

<span class="sd">        :type dataset_name: string</span>
<span class="sd">        :param dataset_name: name of dataset that the estimator was trained on.</span>

<span class="sd">        :type root_dir: string</span>
<span class="sd">        :param root_dir: root dir where the trained estimators will be saved. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">root_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">dataset_name</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">root_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">dataset_name</span><span class="p">)</span>
        
        <span class="n">trained_model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">root_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">dataset_name</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">model_name</span> <span class="o">+</span> <span class="n">HDF5_EXTENTION</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="DiskOperations.check_path_exists"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.DiskOperations.check_path_exists">[docs]</a>    <span class="k">def</span> <span class="nf">check_path_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_to_file</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether path exists on disk</span>
<span class="sd">        Args:</span>
<span class="sd">            path_to_file (string): path to check whether exists or not </span>
<span class="sd">        Returns:</span>
<span class="sd">            (Bolean, String): A pickle the first element indicates whether the path exists and the second element returns the actual file path.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path_exists</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">path_to_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">path_exists</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">path_exists</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">path_exists</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Multiple files found: </span><span class="si">{path_to_file}</span><span class="s1">.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="DiskOperations.create_directory_on_hdd"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.DiskOperations.create_directory_on_hdd">[docs]</a>    <span class="k">def</span> <span class="nf">create_directory_on_hdd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates directory on hard drive</span>

<span class="sd">        :type directory_path: string.</span>
<span class="sd">        :param directory_path: path of directory that will be created.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">directory_path</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div></div>
<div class="viewcode-block" id="FilesIO"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.FilesIO">[docs]</a><span class="k">class</span> <span class="nc">FilesIO</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Methods for manipulating HDF5 databases and datasets.</span>

<span class="sd">    :type hdf5_filename: string</span>
<span class="sd">    :param hdf5_filename: full path where the database file will be stored.</span>

<span class="sd">    :type mode: string</span>
<span class="sd">    :param mode: open and create file modes as per the `h5py documentation &lt;http://docs.h5py.org/en/latest/high/file.html&gt;`_.</span>
<span class="sd">    </span>
<span class="sd">    :type experiments_predictions_group: string</span>
<span class="sd">    :param experiments_predictions_group: Location in HDF5 database where estimator predictions will be saved.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hdf5_filename</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> 
                 <span class="n">experiments_predictions_group</span><span class="o">=</span><span class="n">EXPERIMENTS_PREDICTIONS_GROUP</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hdf5_filename</span> <span class="o">=</span> <span class="n">hdf5_filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_experiments_predictions_group</span><span class="o">=</span><span class="n">experiments_predictions_group</span>


<div class="viewcode-block" id="FilesIO.check_h5_path_exists"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.FilesIO.check_h5_path_exists">[docs]</a>    <span class="k">def</span> <span class="nf">check_h5_path_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_to_check</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether path/group exists in HDF5 database</span>

<span class="sd">        :type path_to_check: string</span>
<span class="sd">        :param path_to_check: path of group that will be checked.</span>
<span class="sd">        :rtype: `boolean`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hdf5_filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span>
        <span class="n">is_present</span> <span class="o">=</span> <span class="n">path_to_check</span> <span class="ow">in</span> <span class="n">f</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">is_present</span> </div>

<div class="viewcode-block" id="FilesIO.load_predictions_for_dataset"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.FilesIO.load_predictions_for_dataset">[docs]</a>    <span class="k">def</span> <span class="nf">load_predictions_for_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads predictions generated my trained estimator models.</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset_name(string): Name of dataset on which estimators were trained</span>
<span class="sd">        Retuns:</span>
<span class="sd">            predictions_for_dataset(`array): Array in the form [[strategy name][predictions]]`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hdf5_filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span>
        <span class="n">load_path</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;/</span><span class="si">{self._experiments_predictions_group}</span><span class="s1">/</span><span class="si">{dataset_name}</span><span class="s1">&#39;</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">load_path</span><span class="p">]</span>
        
        
        <span class="n">predictions_for_dataset</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">predictions</span><span class="p">):</span>
            <span class="n">predictions_for_dataset</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">strategy</span><span class="p">,</span> <span class="n">predictions</span><span class="p">[</span><span class="n">strategy</span><span class="p">][</span><span class="o">...</span><span class="p">]])</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">predictions_for_dataset</span></div>


    <span class="c1"># def save_trained_models_to_disk(self, trained_models, dataset_name):</span>
    <span class="c1">#     with open(EXPERIMENTS_TRAINED_MODELS_DIR + dataset_name + PICKLE_EXTENTION,&#39;wb&#39;) as f:</span>
    <span class="c1">#         pickle.dump(trained_models,f)</span>
    
<div class="viewcode-block" id="FilesIO.save_prediction_to_db"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.FilesIO.save_prediction_to_db">[docs]</a>    <span class="k">def</span> <span class="nf">save_prediction_to_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">strategy_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the prediction of a single trained estimator in HDF5 database.</span>

<span class="sd">        Args:</span>
<span class="sd">            predictions(numpy array): array with predictions.</span>
<span class="sd">            dataset_name(string): dataset_name: name of dataset on which the estimator was trained.</span>
<span class="sd">            strategy_name(string):strategy_name: name of estimator/strategy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hdf5_filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{self._experiments_predictions_group}</span><span class="s1">/</span><span class="si">{dataset_name}</span><span class="s1">/</span><span class="si">{strategy_name}</span><span class="s1">&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">save_path_exists</span> <span class="o">=</span> <span class="n">save_path</span> <span class="ow">in</span> <span class="n">f</span>
            <span class="k">if</span> <span class="n">save_path_exists</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">f</span><span class="p">[</span><span class="n">save_path</span><span class="p">]</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Overriding prediction for </span><span class="si">{strategy_name}</span><span class="s1"> on </span><span class="si">{dataset_name}</span><span class="s1">.&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="p">[</span><span class="n">save_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Prediction of </span><span class="si">{strategy_name}</span><span class="s1"> on </span><span class="si">{dataset_name}</span><span class="s1"> stored in database.&#39;</span><span class="p">)</span> 
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Exception occurred: </span><span class="si">{e}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="FilesIO.save_predictions_to_db"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.FilesIO.save_predictions_to_db">[docs]</a>    <span class="k">def</span> <span class="nf">save_predictions_to_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Bulk save of predictions generated by a several trained estimators.</span>

<span class="sd">        :type predictions: array </span>
<span class="sd">        :param predictions: array in form [[estimator name][predictions]]</span>

<span class="sd">        :type dataset_name: string</span>
<span class="sd">        :param dataset_name: Name of dataset on which the estimator was trained.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO this seems a duplicate to def save_numpy_array_hdf5</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hdf5_filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">prediction</span> <span class="ow">in</span> <span class="n">predictions</span><span class="p">:</span>
            <span class="n">strategy_name</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">strategy_predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">prediction</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">save_path</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{self._experiments_predictions_group}</span><span class="s1">/</span><span class="si">{dataset_name}</span><span class="s1">/</span><span class="si">{strategy_name}</span><span class="s1">&#39;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">f</span><span class="p">[</span><span class="n">save_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">strategy_predictions</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Predictions of </span><span class="si">{strategy_name}</span><span class="s1"> on </span><span class="si">{dataset_name}</span><span class="s1"> stored in database.&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Exception while saving: </span><span class="si">{e}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
<div class="viewcode-block" id="FilesIO.save_array_hdf5"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.FilesIO.save_array_hdf5">[docs]</a>    <span class="k">def</span> <span class="nf">save_array_hdf5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">array_names</span><span class="p">,</span> <span class="n">array_meta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves an array of data to HDF5 database</span>

<span class="sd">        :type group:string</span>
<span class="sd">        :param group: path to group in HDF5 where the arrays will be saved</span>

<span class="sd">        :type datasets: array of arrays</span>
<span class="sd">        :param datasets: array in the form [[x_1],[x_2],...[x_n]] representing the data that will be saved. Each x_i is saved</span>
<span class="sd">                         in a different sub-group under the common parent HDF5 group.</span>
<span class="sd">        :type array_names: array of strings</span>
<span class="sd">        :param array_names: name of sub-groups where the dataset arrays will be saved</span>

<span class="sd">        :type array_meta: array of dictionaries</span>
<span class="sd">        :param array_meta: metadata for each sub-group </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#TODO metadata not saved</span>
        <span class="c1">#create groups</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hdf5_filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dts</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">array_names</span><span class="p">,</span> <span class="n">array_meta</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">dts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">dts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">meta</span> <span class="o">=</span> <span class="n">dts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">f</span><span class="p">[</span><span class="n">group</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
            <span class="c1">#save metadata</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">meta</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">f</span><span class="p">[</span><span class="n">group</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
            
    <span class="c1"># def save_prediction_accuracies_to_db(self, model_accuracies):</span>
    <span class="c1">#     for model in model_accuracies:</span>
    <span class="c1">#         model_name = model[0]</span>
    <span class="c1">#         model_accuracy = np.array([model[1]])</span>
            
    <span class="c1">#         #create group if necessary</span>
    <span class="c1">#         f =  h5py.File(self.hdf5_filename, self._mode)</span>
    <span class="c1">#         if not &#39;/&#39; + EXPERIMENTS_MODEL_ACCURACY_DIR in f:</span>
    <span class="c1">#             f.create_group(&#39;/&#39; + EXPERIMENTS_MODEL_ACCURACY_DIR)</span>
    <span class="c1">#         f.close()            </span>
    <span class="c1">#         #create array with accuracies or append it</span>
    <span class="c1">#         f = tables.open_file(self.hdf5_filename, self._mode)</span>
    <span class="c1">#         if not  &#39;/&#39; + EXPERIMENTS_MODEL_ACCURACY_DIR + model_name in f: </span>
    <span class="c1">#             f.create_earray(&#39;/&#39; +EXPERIMENTS_MODEL_ACCURACY_DIR, name=model_name, obj=model_accuracy)</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             mdl_acc = getattr(f.root.experiments.trained_models_accuracies, model_name)</span>
    <span class="c1">#             mdl_acc.append(model_accuracy)</span>
    <span class="c1">#         f.close()</span>
            
    <span class="c1"># def get_prediction_accuracies_per_strategy(self):</span>
    <span class="c1">#     pred_accuracies = {}</span>
    <span class="c1">#     f = h5py.File(self.hdf5_filename, self._mode)</span>
    <span class="c1">#     strategies = f[EXPERIMENTS_MODEL_ACCURACY_DIR]</span>
    <span class="c1">#     for strategy in strategies:</span>
    <span class="c1">#         pred_accuracies[strategy] = strategies[strategy][...]</span>
    <span class="c1">#     return pred_accuracies</span>
    
<div class="viewcode-block" id="FilesIO.save_ml_strategy_timestamps"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.FilesIO.save_ml_strategy_timestamps">[docs]</a>    <span class="k">def</span> <span class="nf">save_ml_strategy_timestamps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestamps_df</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">overwrite_timestamp</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves start and end times for training estimators.</span>
<span class="sd">        Args:</span>
<span class="sd">            timestamps_df (DataFrame): Dataframe containing: [strategy_name, </span>
<span class="sd">                                                    begin_timestamp, </span>
<span class="sd">                                                    end_timestamp,</span>
<span class="sd">                                                    difference between start and end timestamp]</span>

<span class="sd">            dataset_name(string): name of dataset on which the estimator was trained.</span>
<span class="sd">            overwrite_timestamp(Boolean): overwrite timestamps if they exist already</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">store</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">HDFStore</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hdf5_filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span>
        <span class="n">dts_path</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{RUNTIMES_GROUP}</span><span class="s1">/</span><span class="si">{dataset_name}</span><span class="s1">&#39;</span>
        <span class="n">timestamp_exits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_h5_path_exists</span><span class="p">(</span><span class="n">dts_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">overwrite_timestamp</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">or</span> <span class="n">timestamp_exits</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">store</span><span class="p">[</span><span class="n">dts_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">timestamps_df</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prior_timestamp</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_dataset_pd</span><span class="p">(</span><span class="n">dts_path</span><span class="p">,</span> <span class="n">return_metadata</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">timestamps_df</span> <span class="o">=</span> <span class="n">timestamps_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prior_timestamp</span><span class="p">)</span>
            <span class="n">store</span><span class="p">[</span><span class="n">dts_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">timestamps_df</span>
        <span class="n">store</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
    
  
<div class="viewcode-block" id="FilesIO.list_datasets"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.FilesIO.list_datasets">[docs]</a>    <span class="k">def</span> <span class="nf">list_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hdf5_group</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists all datasets/sub-groups in an HDF5 group</span>

<span class="sd">        Args:</span>
<span class="sd">            hdf5_group(string): hdf5_group: path to HDf5 group</span>
<span class="sd">        Returns:</span>
<span class="sd">            `array of strings`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hdf5_filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">hdf5_group</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Group </span><span class="si">{hdf5_group}</span><span class="s1"> does not exist in {self._hdf5_filename,}&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">f</span><span class="p">[</span><span class="n">hdf5_group</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">datasets</span></div>

<div class="viewcode-block" id="FilesIO.load_dataset_h5"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.FilesIO.load_dataset_h5">[docs]</a>    <span class="k">def</span> <span class="nf">load_dataset_h5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads dataset from HDF5 database. The dataset needs to have been saved as a numpy array originally</span>

<span class="sd">        :type dataset_path: string</span>
<span class="sd">        :param dataset_path: path to dataset.</span>

<span class="sd">        :rtype: `numpy array, metadata dictionary`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hdf5_filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">dataset_path</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
        <span class="c1">#load metadata</span>
        <span class="n">meta</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">dataset_path</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="n">meta_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">meta</span><span class="p">:</span>
            <span class="n">meta_dict</span><span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">idx</span><span class="p">,</span> <span class="n">meta_dict</span></div>
        
<div class="viewcode-block" id="FilesIO.load_dataset_pd"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.FilesIO.load_dataset_pd">[docs]</a>    <span class="k">def</span> <span class="nf">load_dataset_pd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_path</span><span class="p">,</span> <span class="n">return_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads dataset from HDF5 database. The dataset needs to have been saved as a pandas Datafram originally</span>

<span class="sd">        Args:</span>
<span class="sd">            dataset_path(string): path to dataset.</span>
<span class="sd">            return_metadata(Boolean): Flag whether the metadata should be returned</span>
<span class="sd">        Returns:</span>
<span class="sd">            `pandas DataFrame, metadata dictionary`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">store</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">HDFStore</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hdf5_filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span>
        <span class="n">dataset</span> <span class="o">=</span> <span class="n">store</span><span class="p">[</span><span class="n">dataset_path</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">return_metadata</span><span class="p">:</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">get_storer</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">metadata</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">store</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">metadata</span></div>
<div class="viewcode-block" id="FilesIO.save_pandas_dataset"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.FilesIO.save_pandas_dataset">[docs]</a>    <span class="k">def</span> <span class="nf">save_pandas_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">save_loc</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves a dataset stored in DataFrame format in the database</span>

<span class="sd">        Parameters</span>
<span class="sd">        -----------</span>
<span class="sd">        dataset (DataFrame): Dataset that will be saved in the databse</span>
<span class="sd">        save_path(string): group in HDF5 database where the data will be saved</span>
<span class="sd">        metadata(JSON): Must contain ``class_name``, and ``dataset_name`` key-value pairs</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">store</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">HDFStore</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hdf5_filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span>
        <span class="n">dts_name</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;dataset_name&#39;</span><span class="p">]</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{save_loc}</span><span class="s1">/</span><span class="si">{dts_name}</span><span class="s1">&#39;</span>
        <span class="n">store</span><span class="p">[</span><span class="n">save_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataset</span>
        <span class="n">store</span><span class="o">.</span><span class="n">get_storer</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span>
        <span class="n">store</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="FilesIO.save_datasets"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.FilesIO.save_datasets">[docs]</a>    <span class="k">def</span> <span class="nf">save_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">datasets_save_paths</span><span class="p">,</span> <span class="n">dts_metadata</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="c1">#TODO This function needs to be removed together with its implementation in the data package</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        saves datasets in HDF5 database. </span>
<span class="sd">        dataset_names must contain full path.</span>

<span class="sd">        :type datasets: array of pandas DataFrame</span>
<span class="sd">        :param datasets: array of datasets formatted as pandas DataFrame.</span>

<span class="sd">        :type datasets_save_paths: array of string</span>
<span class="sd">        :param datasets_save_paths: Array with the save locations for each dataset.</span>

<span class="sd">        :type dts_meta: array of dictionaries</span>
<span class="sd">        :param dts_meta: Metadata for each dataset.</span>

<span class="sd">        :type verbose: boolean</span>
<span class="sd">        :param verbose: Display or not progress with saving the datasets.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">store</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">HDFStore</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hdf5_filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mode</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dts</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">dts_metadata</span><span class="p">,</span> <span class="n">datasets_save_paths</span><span class="p">):</span>
            
            <span class="n">dts_name</span> <span class="o">=</span> <span class="n">dts</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;dataset_name&#39;</span><span class="p">]</span>     
            <span class="n">save_loc</span> <span class="o">=</span> <span class="n">dts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>    
            <span class="n">store</span><span class="p">[</span><span class="n">save_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">dts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">store</span><span class="o">.</span><span class="n">get_storer</span><span class="p">(</span><span class="n">save_loc</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">dts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">verbose</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Saved: </span><span class="si">{dts_name}</span><span class="s1"> to HDF5 database&#39;</span><span class="p">)</span>
        <span class="n">store</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="FilesIO.split_dataset"><a class="viewcode-back" href="../../../shared.html#mlaut.shared.files_io.FilesIO.split_dataset">[docs]</a>    <span class="k">def</span> <span class="nf">split_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset_path</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Splits dataset in train and test set.</span>

<span class="sd">        :type dataset_path: string</span>
<span class="sd">        :param dataset_path: Path to dataset</span>

<span class="sd">        :type test_size: float</span>
<span class="sd">        :param test_size: Fraction of samples that will be put in test set</span>

<span class="sd">        :rtype: tuple of four arrays (X_train, X_test, y_train, y_test)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#load</span>
        <span class="n">dataset</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">dataset_path</span><span class="p">)</span>
        <span class="n">class_name</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;class_name&#39;</span><span class="p">]</span>
        <span class="n">dataset_name</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;dataset_name&#39;</span><span class="p">]</span>
        <span class="c1">#split</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">class_name</span><span class="p">]</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">class_name</span><span class="p">]</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
                <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
        <span class="c1">#reformat y_train and y_test</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>  
                <span class="n">y_test</span><span class="p">)</span></div></div>
         
 
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Viktor Kazakov.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'0.0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>